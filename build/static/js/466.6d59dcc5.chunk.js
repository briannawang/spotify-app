"use strict";(self.webpackChunkspotify_app=self.webpackChunkspotify_app||[]).push([[466],{466:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var r=n(152),a=n(791),o=(n(508),function(e,t){var n=e.map((function(e){var n=Array.isArray(e)?e:e.split(",").map(Number);return"hex"===t.format?i(n):n}));return 1===t.amount||1===n.length?n[0]:n}),s=function(e,t){var n=Math.round(e/t)*t;return Math.min(n,255)},i=function(e){return"#"+e.map((function(e){var t=e.toString(16);return 1===t.length?"0"+t:t})).join("")},c=function(e,t){for(var n=4*t.sample,a={},i=0;i<e.length;i+=n){var c=[s(e[i],t.group),s(e[i+1],t.group),s(e[i+2],t.group)].join();a[c]=a[c]?a[c]+1:1}return o(Object.entries(a).sort((function(e,t){var n=(0,r.Z)(e,2),a=(n[0],n[1]),o=(0,r.Z)(t,2);o[0];return a>o[1]?-1:1})).slice(0,t.amount).map((function(e){return(0,r.Z)(e,1)[0]})),t)},u=function(e,t,n){return new Promise((function(r,a){return(o=function(e){return"string"===typeof e?e:e.src}(t),new Promise((function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d"),a=new Image;a.onload=function(){n.height=a.height,n.width=a.width,r.drawImage(a,0,0);var t=r.getImageData(0,0,a.width,a.height).data;e(t)},a.onerror=function(){return t(Error("Image loading failed."))},a.crossOrigin="",a.src=o}))).then((function(t){return r(e(t,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.amount,n=void 0===t?3:t,r=e.format,a=void 0===r?"array":r,o=e.group,s=void 0===o?20:o,i=e.sample;return{amount:n,format:a,group:s,sample:void 0===i?10:i}}(n)))})).catch((function(e){return a(e)}));var o}))},d=n(890),l=n(184),m=a.lazy((function(){return n.e(738).then(n.bind(n,738))})),p=a.lazy((function(){return n.e(819).then(n.bind(n,819))})),f={uri:"",id:"",name:"",album:{images:[{url:""}]},artists:[{name:""}],duration_ms:0};function h(e){var t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return t+":"+(n<10?"0":"")+n}function v(e){var t=(0,r.Z)(e,3),n=t[0],a=t[1],o=t[2];o/=100;var s=a*Math.min(o,1-o)/100,i=function(e){var t=(e+n/30)%12,r=o-s*Math.max(Math.min(t-3,9-t,1),-1);return Math.round(255*r).toString(16).padStart(2,"0")};return"#".concat(i(0)).concat(i(8)).concat(i(4))}var g=function(e){var t=(0,r.Z)(e,3),n=t[0],a=t[1],o=t[2];n/=255,a/=255,o/=255;var s=Math.max(n,a,o),i=s-Math.min(n,a,o),c=i?s===n?(a-o)/i:s===a?2+(o-n)/i:4+(n-a)/i:0;return[60*c<0?60*c+360:60*c,100*(i?s<=.5?i/(2*s-i):i/(2-(2*s-i)):0),100*(2*s-i)/2]};function y(e){var t=(0,r.Z)(e,3),n=t[0],a=t[1],o=t[2];return[n,a-(a>30?10+a/25:a/3),o-(o>20?10+o/30:a/3)]}function _(e){var t,n;(t=e.album.images[0].url,n={amount:15},u(c,t,n)).then((function(e){for(var t=[0,0,0],n=!1,r=0;r<e.length;r++){var a=g(e[r]);if(a[1]>t[1]&&a[2]>25){n=!0,(t=a)[1]<30&&t[1]>5?t[1]=30:t[1]<=5?t[1]*=1.7:t[1]>50&&(t[1]=1.3*t[1]>100?100:1.3*t[1]),t[2]<50&&(t[2]=50),document.documentElement.style.setProperty("--swatch",v(t)),document.documentElement.style.setProperty("--dark_swatch",v(y(t)));break}}n||(document.documentElement.style.setProperty("--swatch","#FFFFFF"),document.documentElement.style.setProperty("--dark_swatch","#B9BBC7"))})).catch((function(){document.documentElement.style.setProperty("--swatch","#FFFFFF"),document.documentElement.style.setProperty("--dark_swatch","#B9BBC7")}))}var w=function(e){var t=e.token,n=e.userProfile,o=(0,a.useRef)(!0),s=(0,a.useState)(!1),i=(0,r.Z)(s,2),c=i[0],u=i[1],v=(0,a.useState)(void 0),g=(0,r.Z)(v,2),y=g[0],w=g[1],k=(0,a.useState)(f),x=(0,r.Z)(k,2),j=x[0],b=x[1],N=(0,a.useState)(0),S=(0,r.Z)(N,2),C=S[0],F=S[1],P=(0,a.useState)(0),E=(0,r.Z)(P,2),Z=E[0],R=E[1],I=(0,a.useState)(""),A=(0,r.Z)(I,2),B=A[0],M=A[1],T=(0,a.useState)(!1),D=(0,r.Z)(T,2),q=D[0],z=D[1],H={width:100*C/Z+"%"};return(0,a.useEffect)((function(){var e=document.createElement("script");e.src="https://sdk.scdn.co/spotify-player.js",e.async=!0,document.body.appendChild(e),c||(window.onSpotifyWebPlaybackSDKReady=function(){var e=new window.Spotify.Player({name:"spotify app",getOAuthToken:function(e){console.log("token got "+t),e(t)},volume:.4});w(e),e.addListener("ready",(function(e){var t=e.device_id;M(t),console.log("Ready with Device ID",t)})),e.addListener("not_ready",(function(e){var t=e.device_id;console.log("Device ID has gone offline",t)})),e.addListener("player_state_changed",(function(n){n&&(j!==n.track_window.current_track&&(d.ajax({url:"https://api.spotify.com/v1/me/player",type:"GET",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t),e.setRequestHeader("Content-Type","application/json")},success:function(e){e&&R(e.item.duration_ms)}}),b(n.track_window.current_track),_(n.track_window.current_track)),F(n.position),o.current=n.paused,e.getCurrentState().then((function(e){u(!!e)})))})),e.connect()});var n=setInterval((function(){o.current||F((function(e){return e+100}))}),100,!o.current);return function(){clearInterval(n)}}),[]),(0,l.jsxs)("div",{className:"container",children:[c?(0,l.jsxs)("div",{className:"main-wrapper",children:[(0,l.jsx)("img",{src:j.album.images[0].url,className:"now-playing__img",alt:""}),(0,l.jsxs)("div",{className:"now-playing__side",children:[(0,l.jsx)("div",{className:"now-playing__name",children:j.name}),(0,l.jsxs)("div",{className:"now-playing__artist",children:[j.artists[0].name,j.artists[1]&&", "+j.artists[1].name]}),(0,l.jsxs)("div",{className:"control-btns",children:[(0,l.jsx)("button",{className:"btn-spotify",onClick:function(){y.previousTrack()},children:"\u25c4\u23fd"}),(0,l.jsx)("button",{className:"btn-spotify",id:"toggle-play",onClick:function(){y.togglePlay()},children:o.current?"play":"pause"}),(0,l.jsx)("button",{className:"btn-spotify",onClick:function(){y.nextTrack()},children:"\u23fd\u25ba"})]}),(0,l.jsxs)("div",{className:"song-timeinfo",children:[(0,l.jsx)("div",{className:"progress-background",children:(0,l.jsx)("div",{className:"progress",children:(0,l.jsx)("div",{className:"progress__bar",style:H})})}),(0,l.jsxs)("div",{className:"song-progress",children:[(0,l.jsx)("p",{className:"song-progress__position",children:h(C)}),(0,l.jsx)("p",{className:"song-progress__duration",children:h(Z)})]})]})]})]}):(0,l.jsx)("div",{className:"main-wrapper",children:(0,l.jsx)("p",{id:"background-text-color",onClick:function(){!function(e,t){""!=e&&(d.ajax({url:"https://api.spotify.com/v1/me/player",type:"PUT",data:'{"device_ids":["'+e+'"]}',beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t),e.setRequestHeader("Content-Type","application/json")}}),console.log("TRANSFERRED PLAYBACK"))}(B,t)},children:" transfer playback device "})}),!c||q?(0,l.jsx)(p,{token:t,userId:n.id}):(0,l.jsx)("div",{className:"TrackAudioInfo",children:(0,l.jsx)(m,{token:t,current_track:j,is_pausedRef:o.current})}),(0,l.jsx)("button",{className:"sidebar_button",onClick:function(){c&&z((function(e){return!e}))},children:"\u25fc"})]})}}}]);
//# sourceMappingURL=466.6d59dcc5.chunk.js.map